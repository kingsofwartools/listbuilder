{"version":3,"sources":["components/common/Button.js","components/unit/UnitHeader.js","components/unit/UnitTableRow.js","components/unit/UnitTable.js","components/unit/UnitOptions.js","components/unit/UnitArtefacts.js","helpers/arcane-library.js","components/unit/UnitFooter.js","components/unit/MultiUnit.js","components/common/ButtonRow.js","components/unit/Formation/FormationSelect.js","components/unit/Unit.js","components/unit/Formation/FormationDisplay.js","components/views/FactionUnitsIndex.js","components/views/UnitSelect.js","components/ExportModal.js","components/common/Banner.js","components/UnlocksBanner.js","components/DuplicatesBanner.js","components/views/ArmyList.js","components/views/ArmiesIndex.js","helpers/unlocks.js","helpers/points.js","helpers/duplicates.js","helpers/artefacts.js","helpers/limits.js","components/views/Index.js","components/views/StandardIndex.js","App.js","serviceWorker.js","index.js"],"names":["Button","text","onClick","disabled","variant","size","data-html2canvas-ignore","className","UnitHeader","unit","displayEditButton","handleClickEdit","displayHeaderCost","unitDetails","unitDescription","includes","type","Row","noGutters","name","Col","unitCost","UnitTableRow","displayAddButton","addUnit","unitWithFormationIndicator","formationUpgrade","affectsValues","reduce","newUnitDetails","affectedValue","modelCount","speed","melee","ranged","defence","height","unitStrength","attacks","nerve","cost","UnitTable","units","Table","map","key","UnitOptions","view","possibleOptions","selectedOptions","selectOption","deselectOption","requiredOptions","nonRequiredOptions","length","filter","find","option","isChecked","selectedOption","hasSameName","nValue","index","ToggleButtonGroup","onChange","handleChange","value","ToggleButton","id","htmlFor","displayNValues","displayCost","UnitArtefacts","availableArtefacts","selectArtefact","selectedArtefacts","sizeModifier","isAllowedTwoArtefacts","filteredArtefacts","artefact","handleSelect","artefactName","selectedArtefact","DropdownButton","onSelect","e","title","sort","a","b","Dropdown","Item","eventKey","as","calculateAvailableSpells","spellcasterLevel","arcaneLibrarySpells","accumulatedSpells","spell","levels","forEach","spellLevel","level","push","limit","n","UnitFooter","enrichedUnit","spellcaster","availableArcaneLibrarySpells","options","enrichUnitOptionsWithArcaneLibrary","higherLevelSpells","allocatedSpell","enrichedOptions","splitSpecialRules","specialRules","split","ruleSection","i","spells","addsKeywords","keywords","join","prohibitsArtefacts","artefactsLimit","MultiUnit","unitOptionsDisplay","optionsArr","processedMatchingOptionIndex","findIndex","processedOption","displayCostIncludesOptionWithCost","toString","displayNValuesIncludesOptionWithNValue","ButtonRow","children","sticky","childButtons","Array","isArray","child","Container","childButton","xs","lg","FormationSelect","army","addFormation","alreadyAddedFormations","formations","formation","formationUnits","formationUnit","armyUnit","unitName","totalOptionsCost","newSpellcasterValue","formationName","formationDescription","description","Unit","FormationDisplay","deleteFormation","formationCost","upgradesCost","totalCost","FactionUnitsIndex","goToDisplay","selectUnit","selectArmy","fromArmyList","displaySelectOtherArmy","defaultTab","setLastTab","handleAddFormationToListWithArmyAndFormation","handleClickAdd","window","scrollTo","mergedFactionList","mergedUnitIndex","unitArr","filterUnitsByLabel","label","typesDict","sizesDict","Hero","WE","useState","filteredMergedUnits","setFilteredMergedUnits","Tabs","defaultActiveKey","unitType","Tab","UnitSelect","armyName","handleAddUnitToListWithArmyAndUnit","editingUnit","hideDeleteButton","editUnit","deleteUnit","deleteConfirm","originalUnitDetails","setEnrichedUnit","previousEnrichedUnit","disablesIrregular","substring","irregular","sum","o","splice","ExportModal","exportElement","pdfTitle","onHide","otherProps","localStorage","pageSize","setPageSize","verticalMargin","Number","setVerticalMargin","horizontalMargin","setHorizontalMargin","fileName","setFileName","exportPdf","html2pdf","pagebreak","mode","margin","filename","image","quality","html2canvas","jsPDF","format","orientation","Modal","aria-labelledby","centered","Header","closeButton","Title","Body","Form","Group","controlId","Label","Control","target","custom","Footer","Banner","Alert","UnlocksBanner","unallocated","tooManyHWMT","hwmt","tooManyTroopsOrIrregular","troopOrIrregular","DuplicatesAndLimitsBanner","tooManyDuplicates","overLimits","artefactDuplicates","ArmyList","armyList","setFromArmyList","points","formationDuplicates","handleDeleteFormationFromList","showModal","setShowModal","htmlForPdfExport","useRef","handleEditUnitClick","handleFormationEditUnitClick","show","current","Object","values","total","armyPoints","ref","faction","DuplicatesBanner","formationGroups","formationsArr","orderedFactionListWithFormations","factionList","element","unitOrFormation","unitId","ArmiesIndex","armies","handleArmyButtonClick","alignmentString","filterString","filteredArmies","alignment","arrayOfArmyArrays","filterAndChunk","flat","armyArr","Good","Neutral","Evil","unlockAmounts","Infantry","Regiment","heroMonsterTitanOrWarEngineUnique","Horde","monsterOrTitan","hero","warEngine","Legion","Chariot","Cavalry","Swarm","calculateUnallocated","unitsArr","unitDetailsArr","troopsAndIrregularUnits","heroes","warEngines","monsters","titans","unlockingUnits","armiesData","unitsWithSlots","matchingUnlockingUnit","unlockingUnit","matchingUnitIndexes","indexesArr","console","log","valid","unlocks","troopIrreg","hasBeenAllocated","nonHero","nonWarEngine","monster","nonMonster","titan","nonTitan","calculatePointsTotal","types","calculateDuplicates","pointsTotal","maxOfAnyHMWT","Math","floor","isTooMany","u","calculateDuplicateArtefacts","artefacts","number","calculateUnitLimits","overLimit","limitedOption","Index","setArmies","isLoaded","setIsLoaded","display","setDisplay","selectedArmy","setSelectedArmy","selectedUnit","setSelectedUnit","setUnallocated","setPoints","setTooManyDuplicates","setOverLimits","setArtefactDuplicates","lastTab","useReducer","armyListState","action","armyListIndex","addUnitToListDispatchFunction","editUnitDispatchFunction","newArmylistState","emptyArmy","deleteUnitDispatchFunction","Error","dispatch","useEffect","unallocatedObj","processUnlocks","newPoints","keys","isTooManyDuplicates","flattenedUnits","processDuplicates","pointsObj","processPoints","processArtefacts","processLimits","handleGoToDisplay","formationLabels","uuidv4","StandardIndex","App","ReactGA","initialize","pageview","exact","path","component","Boolean","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.f40efbb3.chunk.js","sourcesContent":["import React from 'react';\nimport BootstrapButton from 'react-bootstrap/Button';\n\nconst Button = ({ text, onClick, disabled, variant, size }) => {\n  return (\n    <BootstrapButton onClick={onClick} disabled={disabled} variant={variant} size={size} data-html2canvas-ignore className=\"d-print-none\">\n      {text}\n    </BootstrapButton>\n  );\n};\n\nexport default Button;\n","import React from 'react';\nimport Button from 'components/common/Button.js';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\n\nconst UnitHeader = ({ unit, displayEditButton = false, handleClickEdit = false, displayHeaderCost = true }) => {\n  const unitDetails = unit.unitDetails ? unit.unitDetails : unit;\n  const unitDescription = ['Hero', 'War Engine', 'Monster', 'Titan'].includes(unitDetails.size) && unitDetails.size !== unitDetails.type ?\n    `${unitDetails.size} (${unitDetails.type})` :\n    unitDetails.type;\n\n  return (\n    <Row className=\"unit-header\" noGutters>\n      <div className=\"unit-header__unit-name-container\">\n        <p className=\"unit-header__unit-name\">{unitDetails.name}</p>\n        {displayEditButton && <Button text=\"Edit\" onClick={() => handleClickEdit(unit)} size=\"sm\" />}\n      </div>\n      <Col className=\"unit-header__unit-type-container\">\n        <p className=\"unit-header__unit-type\">\n          <span className=\"badge badge-secondary\">{unitDescription}</span>\n          {displayHeaderCost && unit.unitCost && ` ${unit.unitCost}pts`}\n        </p>\n      </Col>\n    </Row>\n  );\n};\n\nexport default UnitHeader;\n","import React from 'react';\nimport Button from '../common/Button';\n\nconst UnitTableRow = ({ unit, displayAddButton = false, addUnit = false }) => {\n  const unitDetails = unit.unitDetails ? unit.unitDetails : unit;\n\n  const unitWithFormationIndicator = (unit.formationUpgrade && unit.formationUpgrade.affectsValues) ?\n    unit.formationUpgrade.affectsValues.reduce((newUnitDetails, affectedValue) => {\n      return {...newUnitDetails, ...affectedValue};\n    }, {...unitDetails}) :\n    unitDetails;\n  return (\n    <tr className=\"unit-table-row\">\n      <td>\n        <p>{`${unitWithFormationIndicator.size} (${unitWithFormationIndicator.modelCount})`}</p>\n      </td>\n      <td>\n        <p>{unitWithFormationIndicator.speed}</p>\n      </td>\n      <td>\n        <p>{unitWithFormationIndicator.melee}</p>\n      </td>\n      <td>\n        <p>{unitWithFormationIndicator.ranged}</p>\n      </td>\n      <td>\n        <p>{unitWithFormationIndicator.defence}</p>\n      </td>\n      <td>\n        <p>{unitWithFormationIndicator.height}</p>\n      </td>\n      <td>\n        <p>{unitWithFormationIndicator.unitStrength}</p>\n      </td>\n      <td>\n        <p>{unitWithFormationIndicator.attacks}</p>\n      </td>\n      <td>\n        <p>{unitWithFormationIndicator.nerve}</p>\n      </td>\n      <td className=\"d-print-none\" data-html2canvas-ignore>\n        <p>{unitWithFormationIndicator.cost}</p>\n      </td>\n      {displayAddButton && (\n        <td className=\"d-print-none\" data-html2canvas-ignore>\n          <Button text=\"Add\" onClick={() => addUnit(unit)} size=\"sm\" />\n        </td>\n      )}\n    </tr>\n  );\n};\n\nexport default UnitTableRow;\n","import React from 'react';\nimport UnitTableRow from './UnitTableRow';\nimport Table from 'react-bootstrap/Table';\n\nconst UnitTable = ({ units, displayAddButton = false, addUnit = false }) => {\n  return (\n    <Table className=\"unit-table\">\n      <tbody>\n        <tr>\n          <th>\n            <p>Unit size</p>\n          </th>\n          <th>\n            <p>Sp</p>\n          </th>\n          <th>\n            <p>Me</p>\n          </th>\n          <th>\n            <p>Ra</p>\n          </th>\n          <th>\n            <p>De</p>\n          </th>\n          <th>\n            <p>H</p>\n          </th>\n          <th>\n            <p>US</p>\n          </th>\n          <th>\n            <p>Att</p>\n          </th>\n          <th>\n            <p>Ne</p>\n          </th>\n          <th className=\"d-print-none\" data-html2canvas-ignore>\n            <p>Pts</p>\n          </th>\n        </tr>\n        {units.map((unit) => (\n          <UnitTableRow\n            key={unit.unitDetails ? `${unit.unitDetails.name}-${unit.unitDetails.size}` : `${unit.name}-${unit.size}`}\n            unit={unit}\n            displayAddButton={displayAddButton}\n            addUnit={addUnit}\n          />\n        ))}\n      </tbody>\n    </Table>\n  );\n};\n\nexport default UnitTable;\n","import React, { Fragment } from 'react';\nimport ToggleButton from 'react-bootstrap/ToggleButton';\nimport ToggleButtonGroup from 'react-bootstrap/ToggleButtonGroup';\n\nconst UnitOptions = ({ view, possibleOptions, selectedOptions, selectOption, deselectOption, requiredOptions }) => {\n  const handleChange = (option) => {\n    selectedOptions.find((selectedOption) => {\n      return (selectedOption.nValue || selectedOption.nValue === 0)\n        ? (selectedOption.name === option.name) && (selectedOption.nValue === option.nValue)\n        : selectedOption.name === option.name;\n    })\n      ? deselectOption(option)\n      : selectOption(option);\n  };\n  const nonRequiredOptions = (requiredOptions && requiredOptions.length) ? possibleOptions.filter(({ name }) => !requiredOptions.find(option => option.name === name)) : possibleOptions;\n\n  const isChecked = (option) => {\n    return !!(\n      selectedOptions &&\n      selectedOptions.find((selectedOption) => {\n        const hasSameName = selectedOption.name === option.name;\n        return (selectedOption.nValue || selectedOption.nValue === 0) ? hasSameName && selectedOption.nValue === option.nValue : hasSameName;\n      })\n    );\n  };\n\n  return (\n    <div className=\"unit-options\">\n      {view === 'unitSelect' ? (\n        <div className=\"unit-options--select\">\n          {(requiredOptions && requiredOptions.length) ?\n            (<p>\n              <span className=\"unit-footer__label\">Required options: </span>\n              {requiredOptions.map((option, index) => (\n                <span key={`${option.name}${(option.nValue || option.nValue === 0) ? option.nValue : ''}`}>\n                  {option.name}\n                  {(option.nValue && ` (${option.nValue})`) || ''} ({option.cost}pts)\n                  {index < requiredOptions.length - 1 ? ', ' : ''}\n                </span>\n              ))}\n            </p>) : null\n          }\n          {nonRequiredOptions.length ? (\n            <Fragment>\n              <p>\n                <span className=\"unit-options__label--select\">Options: </span>\n              </p>\n              <ul className=\"unit-options__list--select\">\n                {nonRequiredOptions.map((option, index) => (\n                  <li key={`${option.name}${(option.nValue || option.nValue === 0) ? option.nValue : ''}`}>\n                    <ToggleButtonGroup type=\"checkbox\" onChange={() => handleChange(option)} value={isChecked(option)}>\n                      <ToggleButton\n                        className={`unit-options__toggle${isChecked(option) ? '--selected' : ''}`}\n                        id={(option.nValue || option.nValue === 0) ? `${option.name}(${option.nValue})-${index}` : `${option.name}-${index}`}\n                        variant={isChecked(option) ? 'success' : 'outline-success'}\n                        size=\"sm\"\n                      >\n                        {option.cost}pts\n                      </ToggleButton>\n                    </ToggleButtonGroup>\n                    <label\n                      htmlFor={(option.nValue || option.nValue === 0) ? `${option.name}(${option.nValue})-${index}` : `${option.name}-${index}`}\n                    >\n                      {option.name}\n                      {(option.nValue && ` (${option.nValue})`) || ''}\n                    </label>\n                  </li>\n                ))}\n              </ul>\n            </Fragment>\n          ) : null}\n        </div>\n      ) : null}\n      {view === 'armyList' && (\n        <div className=\"unit-options--select\">\n          {selectedOptions && selectedOptions.length ? (<p>\n            <span className=\"unit-footer__label\">Options: </span>\n            {selectedOptions.map((option, index) => (\n              <span key={`${option.name}${(option.nValue || option.nValue === 0) ? option.nValue : ''}`}>\n                {option.name}\n                {(option.nValue && ` (${option.nValue})`) || ''} ({option.cost}pts)\n                {index < selectedOptions.length - 1 ? ', ' : ''}\n              </span>\n            ))}\n          </p>) : null}\n        </div>\n      )}\n      {view === 'factionUnitsIndex' && (\n        <div className=\"unit-options--select\">\n          {(nonRequiredOptions && nonRequiredOptions.length &&\n            (\n              <Fragment>\n                <p>\n                  <span className=\"unit-footer__label\">Options: </span>\n                </p>\n                <ul className=\"unit-options__list--view\">\n                  {nonRequiredOptions.map((option) => (\n                    <li key={`${option.name}${(option.nValue || option.nValue === 0) ? option.nValue : ''}`}>\n                      {option.name}\n                      {(option.displayNValues && ` (${option.displayNValues})`) || (option.nValue && ` (${option.nValue})`) || ''}: {option.displayCost || option.cost}pts\n                    </li>\n                  ))}\n                </ul>\n            </Fragment>\n            )) || null}\n          {(requiredOptions && requiredOptions.length &&\n            (<p>\n              <span className=\"unit-footer__label\">Required options: </span>\n              {requiredOptions.map((option, index) => (\n                <span key={`${option.name}${(option.nValue || option.nValue === 0) ? option.nValue : ''}`}>\n                  {option.name}\n                  {(option.displayNValues && ` (${option.displayNValues})`) || (option.nValue && ` (${option.nValue})`) || ''} ({option.cost}pts)\n                  {index < requiredOptions.length - 1 ? ', ' : ''}\n                </span>\n              ))}\n            </p>)) || null\n          }\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default UnitOptions;\n","import React from 'react';\nimport Dropdown from 'react-bootstrap/Dropdown';\nimport DropdownButton from 'react-bootstrap/DropdownButton';\n\nconst UnitArtefacts = ({ view, availableArtefacts, selectArtefact, selectedArtefacts, sizeModifier, isAllowedTwoArtefacts }) => {\n  const filteredArtefacts =\n    availableArtefacts &&\n    availableArtefacts.filter((artefact) => sizeModifier === 'Hero' || artefact.type === 'common');\n\n  const handleSelect = (artefactName, index) => {\n    if (artefactName === 'None') {\n      selectArtefact(null, index);\n    } else {\n      const selectedArtefact = availableArtefacts.find((artefact) => artefact.name === artefactName);\n      selectArtefact({ name: selectedArtefact.name, cost: selectedArtefact.cost[sizeModifier] }, index);\n    }\n  };\n\n  return (\n    <div className=\"unit-artefacts\">\n      {view === 'unitSelect' && (\n        <div className=\"unit-artefacts--select\">\n          <DropdownButton\n            onSelect={(e) => handleSelect(e, 0)}\n            className=\"unit-artefacts__dropdown\"\n            title=\"Artefact\"\n            size=\"sm\"\n          >\n            {filteredArtefacts\n              .sort((a, b) => a.cost[sizeModifier] - b.cost[sizeModifier])\n              .map((artefact) => (\n                <Dropdown.Item\n                  key={artefact.name}\n                  eventKey={artefact.name}\n                  as=\"button\"\n                  className=\"unit-artefacts__dropdown-item\"\n                >\n                  {artefact.name} ({artefact.cost[sizeModifier]}pts)\n                </Dropdown.Item>\n              ))}\n          </DropdownButton>\n          <p>\n            {selectedArtefacts[0] &&\n              `${selectedArtefacts[0].name} (${selectedArtefacts[0] && selectedArtefacts[0].cost}pts)`}\n          </p>\n        </div>\n      )}\n      {isAllowedTwoArtefacts && sizeModifier === 'Hero' && (\n        <div className=\"unit-artefacts--select\">\n          <DropdownButton\n            onSelect={(e) => handleSelect(e, 1)}\n            className=\"unit-artefacts__dropdown\"\n            title=\"Artefact\"\n            size=\"sm\"\n          >\n            {filteredArtefacts\n              .sort((a, b) => a.cost[sizeModifier] - b.cost[sizeModifier])\n              .map((artefact) => (\n                <Dropdown.Item\n                  key={artefact.name}\n                  eventKey={artefact.name}\n                  as=\"button\"\n                  className=\"unit-artefacts__dropdown-item\"\n                >\n                  {artefact.name} ({artefact.cost[sizeModifier]}pts)\n                </Dropdown.Item>\n              ))}\n          </DropdownButton>\n          <p>\n            {selectedArtefacts[1] &&\n              `${selectedArtefacts[1].name} (${selectedArtefacts[1] && selectedArtefacts[1].cost}pts)`}\n          </p>\n        </div>\n      )}\n      {view === 'armyList' && (\n        <div className=\"unit-artefacts--select\">\n          <p>\n            <span className=\"unit-footer__label\">Artefact{selectedArtefacts.length > 1 ? 's' : ''}: </span>\n            {selectedArtefacts.map((artefact, index) => (\n              <span key={artefact.name}>\n                {artefact.name} ({artefact.cost}pts)\n                {index < selectedArtefacts.length - 1 ? ', ' : ''}\n              </span>\n            ))}\n          </p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default UnitArtefacts;\n","import arcaneLibrarySpells from '../data/arcane-library-spells.json';\n\nexport const enrichUnitOptionsWithArcaneLibrary = (unit) => {\n  const spellcasterLevel = unit.unitDetails.spellcaster;\n  const isEligibleForArcaneLibrarySpells = spellcasterLevel && !unit.unitDetails.limit;\n  const knowledgeableOption = {\n    'name': 'Knowledgeable [1]',\n    'cost': 10,\n    'limit': 1,\n    'disablesIrregular': false\n  };\n\n  const tempestOption = {\n    'name': 'Incantation of the Tempest [1]',\n    'cost': 10,\n    'limit': 1,\n    'disablesIrregular': false\n  }\n  \n  if (isEligibleForArcaneLibrarySpells) {\n    const availableArcaneLibrarySpells = calculateAvailableSpells(spellcasterLevel);\n    return { ...unit, unitDetails: { ...unit.unitDetails, options: [...unit.unitDetails.options, knowledgeableOption, tempestOption, ...availableArcaneLibrarySpells] }};\n  } else {\n    return unit;\n  }\n}\n\nexport const calculateAvailableSpells = (spellcasterLevel) => {\n  return arcaneLibrarySpells.reduce((accumulatedSpells, spell) => {\n    spell.levels.forEach((spellLevel) => {\n      if (spellLevel.level <= spellcasterLevel)\n        accumulatedSpells.push({\n          name: spell.name,\n          cost: spellLevel.cost,\n          limit: spell.limit,\n          spellLevel: spellLevel.level,\n          nValue: spellLevel.n,\n        });\n    });\n    return accumulatedSpells;\n  }, []);\n};\n","import React from 'react';\nimport UnitOptions from './UnitOptions';\nimport UnitArtefacts from './UnitArtefacts';\nimport { enrichUnitOptionsWithArcaneLibrary, calculateAvailableSpells } from '../../helpers/arcane-library';\n\nconst UnitFooter = ({ unit, view, selectOption, deselectOption, selectArtefact, availableArtefacts }) => {\n\n  const enrichedUnit = enrichUnitOptionsWithArcaneLibrary(unit);\n  const higherLevelSpells =\n    [...calculateAvailableSpells(unit.unitDetails.spellcaster + 1)].filter(\n      (spell) =>\n        !enrichedUnit.unitDetails.options.find((allocatedSpell) => {\n          return (allocatedSpell.nValue || allocatedSpell.nValue === 0)\n            ? allocatedSpell.name === spell.name && allocatedSpell.nValue === spell.nValue\n            : allocatedSpell.name === spell.name;\n        })\n    );\n\n  let enrichedOptions = (!enrichedUnit.unitDetails.limit &&\n    enrichedUnit.selectedOptions.find((option) => option.name === \"Knowledgeable [1]\")) ? \n    [...enrichedUnit.unitDetails.options, ...higherLevelSpells] : \n    [...enrichedUnit.unitDetails.options];\n\n  const splitSpecialRules = unit.unitDetails.specialRules.includes('\\\\n') ?\n    unit.unitDetails.specialRules.split('\\\\n').map((ruleSection, i) => {\n      if (i < unit.unitDetails.specialRules.split('\\\\n').length - 1) return [<span>{ruleSection}</span>,<br/>]\n      return <span>{ruleSection}</span>;\n    }) :\n    unit.unitDetails.specialRules;\n\n  return (\n    <div className=\"unit-footer\">\n      <div className=\"unit-footer__special\">\n        <p>\n          <span className=\"unit-footer__label\">Special: </span>\n          {splitSpecialRules}{unit.formationUpgrade &&\n            (<span>{splitSpecialRules.length ? ', ' : ''}{unit.formationUpgrade.name}: {unit.formationUpgrade.text} ({unit.formationUpgrade.cost}pts)</span>)\n          }\n        </p>\n        {unit.unitDetails.spells && (\n          <p>\n            <span className=\"unit-footer__label\">Spells: </span>\n            {unit.unitDetails.spells}\n          </p>\n        )}\n        <p>\n          <span className=\"unit-footer__label\">Keywords: </span>\n          {unit.formationUpgrade && unit.formationUpgrade.addsKeywords ? `${unit.unitDetails.keywords}, ${unit.formationUpgrade.addsKeywords.join(', ')}` : unit.unitDetails.keywords}\n        </p>\n        {(unit.unitDetails.spellcaster || unit.unitDetails.spellcaster === 0) && (\n          <p>\n            <span className=\"unit-footer__label\">Spellcaster: </span>\n            {unit.selectedOptions.find(option => option.name === 'Knowledgeable [1]') ? (unit.unitDetails.spellcaster + 1) : unit.unitDetails.spellcaster}\n          </p>\n        )}\n        {(view === 'factionUnitsIndex' || view === 'armyList') ? (\n          <UnitOptions selectedOptions={unit.selectedOptions} requiredOptions={unit.requiredOptions} possibleOptions={enrichedOptions} view={view} />\n        ) : null}\n        {view === 'unitSelect' &&\n        (unit.unitDetails.options.length ||\n          (!unit.unitDetails.limit &&\n            unit.selectedOptions.find((option) => option.name === \"Knowledgeable [1]\"))) ? (\n          <UnitOptions\n            possibleOptions={enrichedOptions}\n            selectedOptions={unit.selectedOptions}\n            view={view}\n            selectOption={selectOption}\n            deselectOption={deselectOption}\n            requiredOptions={unit.requiredOptions}\n          />\n        ) : null}\n        {view === 'armyList' && unit.selectedArtefacts.length ? (\n          <UnitArtefacts selectedArtefacts={unit.selectedArtefacts} view={view} />\n        ) : null}\n        {view === 'unitSelect' &&\n          !['Monster', 'War Engine', 'Titan'].includes(unit.unitDetails.size) &&\n          !(unit.formationUpgrade && unit.formationUpgrade.prohibitsArtefacts) &&\n          !unit.unitDetails.limit && (\n            <UnitArtefacts\n              artefactsLimit={1}\n              availableArtefacts={availableArtefacts}\n              selectedArtefacts={unit.selectedArtefacts}\n              view={view}\n              selectArtefact={selectArtefact}\n              sizeModifier={unit.unitDetails.size}\n            />\n          )}\n      </div>\n    </div>\n  );\n};\n\nexport default UnitFooter;\n","import React from 'react';\nimport UnitHeader from './UnitHeader.js';\nimport UnitTable from './UnitTable.js';\nimport UnitFooter from './UnitFooter.js';\n\nconst MultiUnit = ({ units, addUnit, view, displayAddButton }) => {\n  const unitOptionsDisplay = units.reduce((optionsArr, unit) => {\n    if (unit.unitDetails.options.length) {\n      unit.unitDetails.options.forEach(option => {\n        const processedMatchingOptionIndex = optionsArr.findIndex(processedOption => processedOption.name === option.name);\n        if (processedMatchingOptionIndex !== -1) {\n          const displayCost = optionsArr[processedMatchingOptionIndex].displayCost;\n          const displayCostIncludesOptionWithCost = displayCost && displayCost.split('/').includes((option.cost).toString());\n          if (optionsArr[processedMatchingOptionIndex].cost !== option.cost && (!displayCost || (displayCost && !displayCostIncludesOptionWithCost))) {\n            optionsArr[processedMatchingOptionIndex].displayCost = `${(optionsArr[processedMatchingOptionIndex].displayCost || optionsArr[processedMatchingOptionIndex].cost)}/${option.cost}`\n          }\n          if (option.spellLevel) {\n            const displayNValues = optionsArr[processedMatchingOptionIndex].displayNValues;\n            const displayNValuesIncludesOptionWithNValue = displayNValues && displayNValues.split('/').includes((option.nValue).toString());\n            if ((!displayNValues || (displayNValues && !displayNValuesIncludesOptionWithNValue))) {\n              optionsArr[processedMatchingOptionIndex].displayNValues = `${(optionsArr[processedMatchingOptionIndex].displayNValues || optionsArr[processedMatchingOptionIndex].nValue)}/${option.nValue}`\n            }\n          }\n        } else {\n          optionsArr.push(option);\n        }\n      });\n    }\n    return optionsArr;\n  },[]);\n\n  return (\n    <div className=\"multi-unit-row\">\n      <UnitHeader unit={units[0]} displayHeaderCost={false} />\n      <UnitTable units={units} addUnit={addUnit} displayAddButton={displayAddButton} />\n      <UnitFooter unit={{ ...units[0], unitDetails: { ...units[0].unitDetails, options: unitOptionsDisplay}}} view={view}/>\n    </div>\n  );\n};\n\nexport default MultiUnit;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\n\nconst ButtonRow = ({ children, sticky }) => {\n  const childButtons = Array.isArray(children) ? children.filter((child) => child) : [children];\n\n  return (\n    <Container data-html2canvas-ignore className={`d-print-none button-row__container${sticky ? '--sticky' : ''}`}>\n      <Row className=\"button-row__row\" noGutters={true}>\n        {childButtons.map((childButton, i) => {\n          return (\n            <Col xs={true} lg={false} className=\"button-row__column\" key={i}>\n              {childButton}\n            </Col>\n          );\n        })}\n      </Row>\n    </Container>\n  );\n};\n\nexport default ButtonRow;\n","import React from 'react';\nimport { FormationDisplay } from '.';\n\nconst FormationSelect = ({ army, addFormation, alreadyAddedFormations }) => {\n  return (\n    army.formations.map(formation => {\n      const formationUnits = formation.units.map(formationUnit => {\n        const armyUnit = army.units.find(unit => unit.name === formationUnit.unitName && unit.size === formationUnit.size);\n        const unitCost = formationUnit.formationUpgrade ?\n          armyUnit.cost + formationUnit.formationUpgrade.cost + formationUnit.requiredOptions.reduce((totalOptionsCost, option) => totalOptionsCost + option.cost, 0) :\n          armyUnit.cost + formationUnit.requiredOptions.reduce((totalOptionsCost, option) => totalOptionsCost + option.cost, 0)\n        return {\n          unitDetails: {\n            ...armyUnit,\n            cost: formationUnit.formationUpgrade ? armyUnit.cost + formationUnit.formationUpgrade.cost : armyUnit.cost,\n            spellcaster: formationUnit.formationUpgrade && (formationUnit.formationUpgrade.newSpellcasterValue || formationUnit.formationUpgrade.newSpellcasterValue === 0) ? formationUnit.formationUpgrade.newSpellcasterValue : null,\n          },\n          selectedOptions: formationUnit.requiredOptions,\n          unitCost,\n          selectedArtefacts: [],\n          formation: formation.name,\n          formationUpgrade: formationUnit.formationUpgrade,\n          requiredOptions: formationUnit.requiredOptions\n        }\n      });\n      return (\n        <FormationDisplay\n          key={formation.name}\n          view='factionUnitsIndex'\n          addFormation={addFormation}\n          formationUnits={formationUnits}\n          formationName={formation.name}\n          formationDescription={formation.description}\n          alreadyAddedFormations={alreadyAddedFormations}\n        />\n      )\n    })\n  );\n};\n\nexport default FormationSelect;\n","import React from 'react';\nimport UnitHeader from './UnitHeader';\nimport UnitTable from './UnitTable';\nimport UnitFooter from './UnitFooter';\n\nconst Unit = ({\n  unit,\n  displayEditButton,\n  handleClickEdit,\n  view,\n  selectOption,\n  deselectOption,\n  selectArtefact,\n  availableArtefacts,\n}) => {\n  return (\n    <div className=\"unit-row\">\n      <UnitHeader unit={unit} displayEditButton={displayEditButton} handleClickEdit={handleClickEdit} />\n      <UnitTable units={[unit]} />\n      <UnitFooter\n        unit={unit}\n        view={view}\n        selectOption={selectOption}\n        deselectOption={deselectOption}\n        selectArtefact={selectArtefact}\n        availableArtefacts={availableArtefacts}\n      />\n    </div>\n  );\n};\n\nexport default Unit;\n","import React from 'react';\nimport Button from 'components/common/Button.js';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport MultiUnit from '../MultiUnit';\nimport Unit from '../Unit';\n\nconst FormationDisplay = ({\n  view,\n  addFormation,\n  deleteFormation,\n  formationUnits,\n  formationName,\n  formationDescription,\n  handleClickEdit,\n  alreadyAddedFormations\n}) => {\n  const formationCost = formationUnits.reduce((upgradesCost, unit) => {\n    return unit.formationUpgrade && unit.formationUpgrade.cost ? upgradesCost + unit.formationUpgrade.cost : upgradesCost\n  }, 0);\n  return (\n    <div className=\"formation\" key={formationName}>\n      <Row className=\"formation__formation-header\" noGutters>\n        <div className=\"formation__formation-text-container\">\n          <p className=\"formation__formation-name\">{formationName} <span className=\"formation__formation-cost\">({formationUnits.reduce((totalCost, { unitCost }) => totalCost + unitCost, 0)}pts)</span></p>\n        </div>\n        <Col className=\"formation__formation-button-container\">\n          {view === 'factionUnitsIndex' && <Button variant=\"primary\" disabled={alreadyAddedFormations.includes(formationName)} text=\"Add\" onClick={() => addFormation(formationUnits)} size=\"sm\" />}\n          {view === 'armyList' && <Button variant=\"outline-warning\" text=\"Delete\" onClick={() => deleteFormation(formationUnits)} size=\"sm\" />}\n        </Col>\n      </Row>\n      {formationUnits.map((formationUnit, index) => {\n        return view === 'factionUnitsIndex' ? (\n          <MultiUnit\n            key={`${formationUnit.unitDetails.name}-${index}`}\n            units={[formationUnit]}\n            view='factionUnitsIndex'\n            displayAddButton={false}\n          />\n        ) : (\n          <Unit\n            key={`${formationUnit.unitDetails.name}-${index}`}\n            unit={formationUnit}\n            displayEditButton={view === 'armyList'}\n            handleClickEdit={handleClickEdit}\n            view={view}\n          />\n        )\n      })}\n      {\n        view === 'factionUnitsIndex' &&\n          <div className=\"formation__description-container\">\n            <p className=\"formation__description\">Formation rules:</p>\n            <p className=\"formation__description\">{formationDescription}</p>\n            <p className=\"formation__description\">Cost: {formationCost}pts</p>\n          </div>\n      }\n    </div>\n  );\n};\n\nexport default FormationDisplay;\n","import React, { useState } from 'react';\nimport MultiUnit from 'components/unit/MultiUnit';\nimport Button from 'components/common/Button';\nimport ButtonRow from 'components/common/ButtonRow';\nimport Tabs from 'react-bootstrap/Tabs';\nimport Tab from 'react-bootstrap/Tab';\nimport { FormationSelect } from 'components/unit/Formation';\n\nconst FactionUnitsIndex = ({\n  army,\n  goToDisplay,\n  selectUnit,\n  selectArmy,\n  fromArmyList,\n  displaySelectOtherArmy,\n  defaultTab,\n  setLastTab,\n  handleAddFormationToListWithArmyAndFormation,\n  alreadyAddedFormations\n}) => {\n  // All the units in the selected faction\n\n  const handleClickAdd = (unit) => {\n    selectUnit(unit);\n    selectArmy(army.name);\n    goToDisplay('unitSelect');\n    window.scrollTo(0, 0);\n  };\n\n  const mergedFactionList = [];\n  army.units.forEach((unit) => {\n    const mergedUnitIndex = mergedFactionList.findIndex((unitArr) => unitArr[0].name === unit.name);\n    if (mergedUnitIndex === -1) {\n      mergedFactionList.push([unit]);\n    } else {\n      mergedFactionList[mergedUnitIndex].push(unit);\n    }\n  });\n\n  const filterUnitsByLabel = (label) => {\n    const typesDict = {\n      'Inf/HI': ['Infantry', 'Heavy Infantry'],\n      'Cav/Cht/LC': ['Cavalry', 'Chariot', 'Large Cavalry'],\n      'Sw/LI/MI': ['Swarm', 'Large Infantry', 'Monstrous Infantry'],\n    };\n    const sizesDict = {\n      Hero: ['Hero'],\n      WE: ['War Engine'],\n      'Mon/Tit': ['Monster', 'Titan'],\n    };\n    return label === 'Form' ? [] : [...mergedFactionList].filter((unitArr) => {\n      if (typesDict[label]) {\n        return (\n          typesDict[label].includes(unitArr[0].type) &&\n          !['Hero', 'War Engine', 'Monster', 'Titan'].includes(unitArr[0].size)\n        );\n      } else {\n        return sizesDict[label].includes(unitArr[0].size);\n      }\n    });\n  };\n\n  const [filteredMergedUnits, setFilteredMergedUnits] = useState(filterUnitsByLabel(defaultTab));\n\n  const handleDisplayOtherArmy = () => {\n    goToDisplay('armiesIndex');\n    window.scrollTo(0, 0);\n  };\n\n  const handleSelectTab = (label) => {\n    setFilteredMergedUnits(filterUnitsByLabel(label));\n    setLastTab(label);\n  };\n\n  return (\n    <section className=\"units-index\">\n      {displaySelectOtherArmy && (\n        <ButtonRow sticky={false}>\n          <Button text=\"Select other army\" onClick={handleDisplayOtherArmy} />\n        </ButtonRow>\n      )}\n      <Tabs className=\"units-index__tabs\" onSelect={handleSelectTab} variant=\"tabs\" defaultActiveKey={defaultTab}>\n        {['Inf/HI', 'Cav/Cht/LC', 'Sw/LI/MI', 'Hero', 'WE', 'Mon/Tit'].map((unitType) => {\n          return (\n              <Tab className=\"units-index__tab\" eventKey={unitType} title={unitType} key={unitType}>\n                {filteredMergedUnits.length ? (\n                  filteredMergedUnits.map((unitArr, index) => {\n                    return (\n                      <MultiUnit\n                        units={unitArr.map((unit) => ({\n                          unitDetails: { ...unit },\n                          selectedOptions: [],\n                          unitCost: unit.cost,\n                          selectedArtefacts: [],\n                        }))}\n                        addUnit={handleClickAdd}\n                        key={unitArr[0].name}\n                        view={'factionUnitsIndex'}\n                        displayAddButton={true}\n                      />\n                    );\n                  })\n                ) : (\n                  <p>No units of this type in faction</p>\n                )}\n                {}\n              </Tab>\n          );\n        })}\n        <Tab className=\"units-index__tab\" eventKey='Form' title='Form' key='Form'>\n          <FormationSelect alreadyAddedFormations={alreadyAddedFormations} army={army} addFormation={(formationUnits) => handleAddFormationToListWithArmyAndFormation(army.name, formationUnits)}/>\n        </Tab>\n      </Tabs>\n      <ButtonRow sticky={true}>\n        <Button\n          text=\"Cancel\"\n          onClick={() => goToDisplay(fromArmyList ? 'armyList' : 'armiesIndex')}\n          variant=\"warning\"\n        />\n      </ButtonRow>\n    </section>\n  );\n};\n\nexport default FactionUnitsIndex;\n","import React, { useState } from 'react';\nimport Unit from 'components/unit/Unit';\nimport Button from 'components/common/Button';\nimport ButtonRow from 'components/common/ButtonRow';\n\nconst UnitSelect = ({\n  unit,\n  armyName,\n  goToDisplay,\n  handleAddUnitToListWithArmyAndUnit,\n  editingUnit,\n  hideDeleteButton,\n  editUnit,\n  deleteUnit,\n  deleteConfirm,\n  availableArtefacts,\n}) => {\n  const [enrichedUnit, setEnrichedUnit] = useState(\n    editingUnit && !unit.unitDetails\n      ? { unitDetails: { ...unit }, selectedOptions: [], unitCost: unit.cost, selectedArtefacts: [], originalUnitDetails: unit.originalUnitDetails || { ...unit } }\n      : { ...unit, originalUnitDetails: unit.originalUnitDetails || unit.unitDetails }\n  );\n\n  const handleCancelClick = () => {\n    goToDisplay(editingUnit ? 'armyList' : 'factionUnitsIndex');\n    window.scrollTo(0, 0);\n  };\n\n  const handleSaveClick = () => {\n    editingUnit ? editUnit(enrichedUnit) : handleAddUnitToListWithArmyAndUnit(armyName, enrichedUnit);\n  };\n\n  const handleSelectOption = (option) => {\n    setEnrichedUnit((previousEnrichedUnit) => {\n      return {\n      ...previousEnrichedUnit,\n      unitDetails: {\n        ...previousEnrichedUnit.unitDetails,\n        name: option.disablesIrregular ? previousEnrichedUnit.originalUnitDetails.name.substring(0, previousEnrichedUnit.originalUnitDetails.name.length - 1) : previousEnrichedUnit.originalUnitDetails.name,\n        irregular: option.disablesIrregular ? false : previousEnrichedUnit.unitDetails.irregular,\n      },\n      originalUnitDetails: previousEnrichedUnit.originalUnitDetails,\n      selectedOptions: [...previousEnrichedUnit.selectedOptions, option],\n      unitCost:\n        previousEnrichedUnit.unitDetails.cost +\n        [...previousEnrichedUnit.selectedOptions, option].reduce((sum, o) => sum + o.cost, 0) +\n        [...previousEnrichedUnit.selectedArtefacts].reduce((sum, a) => sum + a.cost, 0),\n    }});\n  };\n\n  const handleDeselectOption = (option) => {\n    \n    setEnrichedUnit((previousEnrichedUnit) => {\n      return {\n        ...previousEnrichedUnit,\n        unitDetails: {\n          ...previousEnrichedUnit.unitDetails,\n          name: previousEnrichedUnit.originalUnitDetails.name,\n          irregular: previousEnrichedUnit.originalUnitDetails.irregular,\n        },\n        originalUnitDetails: previousEnrichedUnit.originalUnitDetails,\n        selectedOptions: previousEnrichedUnit.selectedOptions.filter((selectedOption) => {\n          if (option.name === 'Knowledgeable [1]') {\n            if (selectedOption.spellLevel && (selectedOption.spellLevel > previousEnrichedUnit.originalUnitDetails.spellcaster)) return false;\n          }\n          if (selectedOption.nValue) {\n            if (selectedOption.name === option.name) {\n              return (selectedOption.nValue !== option.nValue);\n            } else {\n              return true;\n            }\n          } else {\n            return (selectedOption.name !== option.name);\n          }\n        }),\n        unitCost:\n          previousEnrichedUnit.unitDetails.cost +\n          previousEnrichedUnit.selectedOptions\n            .filter((selectedOption) => {\n              if (option.name === 'Knowledgeable [1]') {\n                if (selectedOption.spellLevel && (selectedOption.spellLevel > previousEnrichedUnit.originalUnitDetails.spellcaster)) return false;\n              }\n              if (selectedOption.nValue) {\n                if (selectedOption.name === option.name) {\n                  return (selectedOption.nValue !== option.nValue);\n                } else {\n                  return true;\n                }\n              } else {\n                return (selectedOption.name !== option.name);\n              }\n            })\n            .reduce((sum, o) => sum + o.cost, 0) +\n          [...previousEnrichedUnit.selectedArtefacts].reduce((sum, a) => sum + a.cost, 0),\n      };\n    });\n  };\n\n  const handleSelectArtefact = (artefact, index) => {\n    setEnrichedUnit((previousEnrichedUnit) => {\n      if (!artefact) {\n        previousEnrichedUnit.selectedArtefacts.splice(index, 1);\n      } else {\n        previousEnrichedUnit.selectedArtefacts[index] = artefact;\n      }\n      return {\n        ...previousEnrichedUnit,\n        unitCost:\n          previousEnrichedUnit.unitDetails.cost +\n          previousEnrichedUnit.selectedOptions.reduce((sum, o) => sum + o.cost, 0) +\n          [...previousEnrichedUnit.selectedArtefacts].reduce((sum, a) => sum + a.cost, 0),\n      };\n    });\n  };\n\n  const unitDetails = unit.unitDetails ? unit.unitDetails : unit;\n\n  const handleGoToDeleteConfirm = () => {\n    goToDisplay('deleteConfirm');\n    window.scrollTo(0, 0);\n  };\n\n  const handleGoToUnitSelect = () => {\n    goToDisplay('unitSelect');\n    window.scrollTo(0, 0);\n  };\n\n  if (!deleteConfirm) {\n    return (\n      <section className=\"unit-select\">\n        <Unit\n          unit={enrichedUnit}\n          displayEditButton={false}\n          view=\"unitSelect\"\n          selectOption={handleSelectOption}\n          deselectOption={handleDeselectOption}\n          selectArtefact={handleSelectArtefact}\n          availableArtefacts={availableArtefacts}\n        />\n        <ButtonRow sticky={true}>\n          <Button text=\"Save\" onClick={handleSaveClick} variant=\"success\" />\n          {editingUnit && !hideDeleteButton ? <Button text=\"Delete\" onClick={handleGoToDeleteConfirm} variant=\"danger\" /> : null}\n          <Button text=\"Cancel\" onClick={handleCancelClick} variant=\"warning\" />\n        </ButtonRow>\n      </section>\n    );\n  } else {\n    return (\n      <section className=\"delete-confirm\">\n        <div className=\"delete-confirm__container\">\n          <p className=\"h6\">Delete this unit?</p>\n          <p className=\"h5\">{unitDetails.name}</p>\n        </div>\n        <ButtonRow sticky={true}>\n          <Button text=\"Delete\" onClick={() => deleteUnit(unit)} variant=\"danger\" />\n          <Button text=\"Cancel\" onClick={handleGoToUnitSelect} variant=\"warning\" />\n        </ButtonRow>\n      </section>\n    );\n  }\n};\n\nexport default UnitSelect;\n","import React, { useState } from 'react';\nimport Modal from 'react-bootstrap/Modal';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'components/common/Button';\nimport html2pdf from 'html2pdf.js';\n\nexport const ExportModal = ({ exportElement, pdfTitle, onHide, ...otherProps}) => {\n\n  const [pageSize, setPageSize] = useState(localStorage.pageSize || 'a4');\n  const [verticalMargin, setVerticalMargin] = useState((localStorage.verticalMargin && Number(localStorage.verticalMargin)) || 0.5);\n  const [horizontalMargin, setHorizontalMargin] = useState((localStorage.horizontalMargin && Number(localStorage.horizontalMargin)) || 0.5);\n  const [fileName, setFileName] = useState(pdfTitle);\n\n  const exportPdf = async () => {\n    localStorage.pageSize = pageSize;\n    localStorage.verticalMargin = verticalMargin;\n    localStorage.horizontalMargin = horizontalMargin;\n    await html2pdf(exportElement, {\n      pagebreak: {\n        mode: 'css'\n      },\n      margin: [verticalMargin, horizontalMargin],\n      filename: `${fileName}.pdf`,\n      image: { type: 'jpeg', quality: 0.98 },\n      html2canvas: {},\n      jsPDF: { unit: 'in', format: pageSize, orientation: 'portrait' }\n    });\n    onHide();\n  }\n\n  return (\n    <Modal\n      {...otherProps}\n      onHide={() => onHide()}\n      size=\"lg\"\n      aria-labelledby=\"contained-modal-title-vcenter\"\n      centered\n    >\n      <Modal.Header closeButton>\n        <Modal.Title id=\"contained-modal-title-vcenter\">\n          Export as pdf\n        </Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        <Form>\n          <Form.Group controlId=\"exportPdfForm.fileName\">\n            <Form.Label>Filename</Form.Label>\n            <Form.Control type=\"text\" value={fileName} onChange={({ target: { value } }) => setFileName(value)}/>\n          </Form.Group>\n          <Form.Group controlId=\"exportPdfForm.pageSize\">\n            <Form.Label>Page size</Form.Label>\n            <Form.Control value={pageSize} onChange={({ target: { value }}) => setPageSize(value)} as=\"select\" custom>\n              <option value=\"a4\">A4</option>\n              <option value=\"letter\">Letter</option>\n            </Form.Control>\n          </Form.Group>\n          <Form.Group controlId=\"exportPdfForm.verticalMargin\">\n            <Form.Label>Vertical Margin</Form.Label>\n            <Form.Control value={verticalMargin} onChange={({ target: { value }}) => setVerticalMargin(Number(value))} as=\"select\" custom>\n              <option value=\"0.25\">0.25\"</option>\n              <option value=\"0.5\">0.5\"</option>\n              <option value=\"1\">1\"</option>\n            </Form.Control>\n          </Form.Group>\n          <Form.Group controlId=\"exportPdfForm.horizontalMargin\">\n            <Form.Label>Horizontal Margin</Form.Label>\n            <Form.Control value={horizontalMargin} onChange={({ target: { value }}) => setHorizontalMargin(Number(value))} as=\"select\" custom>\n              <option value=\"0.25\">0.25\"</option>\n              <option value=\"0.5\">0.5\"</option>\n              <option value=\"1\">1\"</option>\n            </Form.Control>\n          </Form.Group>\n        </Form>\n      </Modal.Body>\n      <Modal.Footer>\n        <Button text=\"Export\" onClick={exportPdf}/>\n      </Modal.Footer>\n    </Modal>\n  );\n}\n","import React from 'react';\nimport Alert from 'react-bootstrap/Alert';\n\nconst Banner = ({ text }) => {\n  return (\n    <Alert variant=\"danger\" className=\"banner\">\n      <p>{text}</p>\n    </Alert>\n  );\n};\n\nexport default Banner;\n","import React from 'react';\nimport Banner from 'components/common/Banner';\n\nconst UnlocksBanner = ({ armyName = null, unallocated = {} }) => {\n  const tooManyHWMT = unallocated[armyName] && unallocated[armyName].hwmt;\n  const tooManyTroopsOrIrregular = unallocated[armyName] && unallocated[armyName].troopOrIrregular;\n\n  return (\n    <div className=\"unlocks-banner\">\n      {tooManyHWMT && (\n        <Banner text=\"Not enough unlocks for the amount of Heroes/War Engines/Monsters/Titans in your list\" />\n      )}\n      {tooManyTroopsOrIrregular && (\n        <Banner text=\"Not enough unlocks for the amount of Troops or Irregular Units in your list\" />\n      )}\n    </div>\n  );\n};\n\nexport default UnlocksBanner;\n","import React from 'react';\nimport Banner from 'components/common/Banner';\n\nconst DuplicatesAndLimitsBanner = ({ tooManyDuplicates = null, overLimits = null, artefactDuplicates = null }) => {\n  return (\n    <div className=\"duplicates-and-limits-banner\">\n      {tooManyDuplicates && (\n        <Banner text=\"Too many Heroes/War Engines/Monsters/Titans of the same type for the current points total\" />\n      )}\n      {overLimits && (\n        <Banner text=\"You are over your limit on one or more living legend units, or units with the same limited or unique upgrade or spell\" />\n      )}\n      {artefactDuplicates && <Banner text=\"Too many units with the same artefact\" />}\n    </div>\n  );\n};\n\nexport default DuplicatesAndLimitsBanner;\n","import React, {useRef, useState} from 'react';\nimport Unit from 'components/unit/Unit';\nimport Button from 'components/common/Button';\nimport ButtonRow from 'components/common/ButtonRow';\nimport { ExportModal } from 'components/ExportModal';\nimport UnlocksBanner from 'components/UnlocksBanner';\nimport DuplicatesBanner from 'components/DuplicatesBanner';\nimport { FormationDisplay } from 'components/unit/Formation';\n\nconst ArmyList = ({\n  armyList,\n  goToDisplay,\n  setFromArmyList,\n  selectUnit,\n  unallocated,\n  points,\n  tooManyDuplicates,\n  overLimits,\n  artefactDuplicates,\n  formationDuplicates,\n  handleDeleteFormationFromList\n}) => {\n  // The list the user has been building\n  const [showModal, setShowModal] = useState(false);\n  const htmlForPdfExport = useRef(null);\n\n  const handleAddUnitClick = () => {\n    goToDisplay('factionUnitsIndex');\n    window.scrollTo(0, 0);\n    setFromArmyList(true);\n  };\n\n  const handleEditUnitClick = (unit) => {\n    selectUnit(unit);\n    goToDisplay('unitSelect');\n    window.scrollTo(0, 0);\n    setFromArmyList(true);\n  };\n\n  const handleFormationEditUnitClick = (unit) => {\n    selectUnit(unit);\n    goToDisplay('unitSelectFormationUnit');\n    window.scrollTo(0, 0);\n    setFromArmyList(true);\n  }\n\n  const handleExportClick = () => {\n    setShowModal(true);\n  }\n\n  return (\n    <>\n      <ExportModal\n        show={showModal}\n        onHide={() => setShowModal(false)}\n        exportElement={htmlForPdfExport.current}\n        pdfTitle={`${armyList[0].name} - ${Object.values(points).reduce((total, armyPoints) => total + armyPoints, 0)}pts`}\n      />\n      <section className=\"army-list\" ref={htmlForPdfExport}>\n        <div className=\"army-list__export\">\n          <Button variant=\"link\" text=\"Export as PDF\" onClick={handleExportClick} size=\"sm\" />\n        </div>\n        {armyList.map((faction) => (\n          <UnlocksBanner key={faction.name} armyName={faction.name} unallocated={unallocated} />\n        ))}\n        <DuplicatesBanner\n          tooManyDuplicates={tooManyDuplicates}\n          overLimits={overLimits}\n          artefactDuplicates={artefactDuplicates}\n          formationDuplicates={formationDuplicates}\n        />\n        {armyList.map((faction) => {\n          const formationsInList = faction.units.reduce((formationsArr, unit) => {\n            if (unit.formation && !formationsArr.includes(unit.formation)) formationsArr.push(unit.formation);\n            return formationsArr;\n          }, []);\n          const formationGroups = formationsInList.map(formationName => (\n            {\n              formationName,\n              units: faction.units.filter(unit => unit.formation === formationName),\n            }\n          ));\n          const orderedFactionListWithFormations = faction.units.reduce((factionList, unit) => {\n            if (!unit.formation) {\n              factionList.push(unit);\n            } else if (!factionList.find(element => element.formationName === unit.formation)) {\n              factionList.push(formationGroups.find(formation => formation.formationName === unit.formation));\n            }\n            return factionList;\n          }, [])\n          return (\n            <div key={faction.name}>\n              <div className=\"army-list__header\">\n                <h2 className=\"army-list__section-heading\">{faction.name}</h2>\n                <div>\n                  <p className=\"army-list__points\">{points[faction.name]} points</p>\n                </div>\n              </div>\n              {orderedFactionListWithFormations.map((unitOrFormation) => {\n                if (unitOrFormation.formationName) {\n                  return <FormationDisplay\n                    key={unitOrFormation.formationName}\n                    view={'armyList'}\n                    deleteFormation={handleDeleteFormationFromList}\n                    formationUnits={unitOrFormation.units}\n                    formationName={unitOrFormation.formationName}\n                    handleClickEdit={handleFormationEditUnitClick}\n                    />\n                } else {\n                  return (\n                    <Unit\n                      unit={unitOrFormation}\n                      key={unitOrFormation.unitId}\n                      displayEditButton={true}\n                      handleClickEdit={handleEditUnitClick}\n                      view={'armyList'}\n                    />\n                  );\n                }\n              })}\n            </div>\n          );\n        })}\n        <ButtonRow sticky={true}>\n          <Button text=\"Add another unit\" onClick={handleAddUnitClick} variant=\"success\" />\n        </ButtonRow>\n      </section>\n    </>\n  );\n};\n\nexport default ArmyList;\n","import React from 'react';\nimport Button from 'components/common/Button';\nimport ButtonRow from 'components/common/ButtonRow';\n\nconst ArmiesIndex = ({ armies, handleArmyButtonClick, goToDisplay }) => {\n  const filterAndChunk = (filterString) => {\n    const filteredArmies = armies.filter((army) => army.alignment === filterString);\n    const arrayOfArmyArrays = [];\n    filteredArmies.forEach((army, i) => {\n      if (i % 3 === 0) {\n        arrayOfArmyArrays.push([army]);\n      } else {\n        arrayOfArmyArrays[arrayOfArmyArrays.length - 1].push(army);\n      }\n    });\n    return arrayOfArmyArrays;\n  };\n  return (\n    <section className=\"armies-index\">\n      {['Good', 'Neutral', 'Evil']\n        .map((alignmentString) => filterAndChunk(alignmentString))\n        .flat()\n        .map((armyArr, i) => {\n          return (\n            <ButtonRow className=\"armies-index__button-row\" key={i}>\n              {armyArr.map((army) => (\n                <Button\n                  text={army.name}\n                  onClick={() => handleArmyButtonClick(army.name)}\n                  key={army.name}\n                  variant={{ Good: 'success', Neutral: 'warning', Evil: 'danger' }[army.alignment]}\n                />\n              ))}\n            </ButtonRow>\n          );\n        })}\n    </section>\n  );\n};\n\nexport default ArmiesIndex;\n","import armiesData from '../data/armies.json';\n\nconst unlockAmounts = {\n  Infantry: {\n    Regiment: {\n      troopOrIrregular: 2,\n      heroMonsterTitanOrWarEngineUnique: 1,\n    },\n    Horde: {\n      troopOrIrregular: 4,\n      monsterOrTitan: 1,\n      hero: 1,\n      warEngine: 1,\n    },\n    Legion: {\n      troopOrIrregular: 4,\n      monsterOrTitan: 1,\n      hero: 1,\n      warEngine: 1,\n    },\n  },\n  'Heavy Infantry': {\n    Regiment: {\n      troopOrIrregular: 2,\n      heroMonsterTitanOrWarEngineUnique: 1,\n    },\n    Horde: {\n      troopOrIrregular: 4,\n      monsterOrTitan: 1,\n      hero: 1,\n      warEngine: 1,\n    },\n    Legion: {\n      troopOrIrregular: 4,\n      monsterOrTitan: 1,\n      hero: 1,\n      warEngine: 1,\n    },\n  },\n  Chariot: {\n    Regiment: {\n      troopOrIrregular: 2,\n      heroMonsterTitanOrWarEngineUnique: 1,\n    },\n    Horde: {\n      troopOrIrregular: 4,\n      monsterOrTitan: 1,\n      hero: 1,\n      warEngine: 1,\n    },\n    Legion: {\n      troopOrIrregular: 4,\n      monsterOrTitan: 1,\n      hero: 1,\n      warEngine: 1,\n    },\n  },\n  Cavalry: {\n    Regiment: {\n      troopOrIrregular: 2,\n      heroMonsterTitanOrWarEngineUnique: 1,\n    },\n    Horde: {\n      troopOrIrregular: 4,\n      monsterOrTitan: 1,\n      hero: 1,\n      warEngine: 1,\n    },\n    Legion: {\n      troopOrIrregular: 4,\n      monsterOrTitan: 1,\n      hero: 1,\n      warEngine: 1,\n    },\n  },\n  'Large Infantry': {\n    Horde: {\n      troopOrIrregular: 2,\n      heroMonsterTitanOrWarEngineUnique: 2,\n    },\n    Legion: {\n      troopOrIrregular: 4,\n      heroMonsterTitanOrWarEngineUnique: 2,\n    },\n  },\n  'Monstrous Infantry': {\n    Horde: {\n      troopOrIrregular: 2,\n      heroMonsterTitanOrWarEngineUnique: 2,\n    },\n    Legion: {\n      troopOrIrregular: 4,\n      heroMonsterTitanOrWarEngineUnique: 2,\n    },\n  },\n  'Large Cavalry': {\n    Horde: {\n      troopOrIrregular: 2,\n      heroMonsterTitanOrWarEngineUnique: 2,\n    },\n    Legion: {\n      troopOrIrregular: 4,\n      heroMonsterTitanOrWarEngineUnique: 2,\n    },\n  },\n  Swarm: {\n    Horde: {\n      troopOrIrregular: 2,\n      heroMonsterTitanOrWarEngineUnique: 2,\n    },\n    Legion: {\n      troopOrIrregular: 4,\n      heroMonsterTitanOrWarEngineUnique: 2,\n    },\n  },\n};\n\nconst calculateUnallocated = (unitsArr) => {\n  const unallocated = {\n    troopOrIrregular: null,\n    hwmt: null,\n  };\n  const unitDetailsArr = unitsArr.map((unit) => unit.unitDetails);\n  const troopsAndIrregularUnits = unitDetailsArr.filter((unit) => unit.irregular || unit.size === 'Troop');\n  const heroes = unitDetailsArr.filter((unit) => unit.size === 'Hero');\n  const warEngines = unitDetailsArr.filter((unit) => unit.size === 'War Engine');\n  const monsters = unitDetailsArr.filter((unit) => unit.size === 'Monster');\n  const titans = unitDetailsArr.filter((unit) => unit.size === 'Titan');\n\n  const { unlockingUnits } = armiesData.find(faction => faction.name === unitsArr[0].armyName);\n\n  const unitsWithSlots = unitDetailsArr.map((unit, index) => {\n    const matchingUnlockingUnit = unlockingUnits.find(unlockingUnit => ((unlockingUnit.name === unit.name) && (unlockingUnit.size === unit.size)));\n    \n    if (matchingUnlockingUnit) {\n      const matchingUnitIndexes = unitDetailsArr.reduce((indexesArr, unitDetails, index) => {\n        if ((unitDetails.name === matchingUnlockingUnit.name)  && (unitDetails.size === matchingUnlockingUnit.size)) return [ ...indexesArr, index];\n        return indexesArr;\n      },[]);\n      console.log('matchingUnitIndexes', matchingUnitIndexes)\n      const valid = matchingUnitIndexes.length <= 3 || index <= matchingUnitIndexes[2];\n      console.log('index', index);\n      console.log('valid', valid);\n      if (valid) return { ...unit, unlocks: {...matchingUnlockingUnit.unlocks} };\n      return unit;\n    } else if (!unit.irregular && unlockAmounts[unit.type] && unlockAmounts[unit.type][unit.size]) {\n      return { ...unit, unlocks: { ...(unlockAmounts[unit.type] && unlockAmounts[unit.type][unit.size]) } };\n    }\n    return unit;\n  });\n\n  troopsAndIrregularUnits.forEach((troopIrreg) => {\n    let hasBeenAllocated = false;\n    unitsWithSlots.forEach((unit) => {\n      if (!hasBeenAllocated) {\n        if (unit.unlocks && unit.unlocks.troopOrIrregular) {\n          unit.unlocks.troopOrIrregular--;\n          hasBeenAllocated = true;\n        }\n      }\n    });\n    if (!hasBeenAllocated) unallocated.troopOrIrregular = true;\n  });\n\n  heroes.forEach((hero) => {\n    let hasBeenAllocated = false;\n    unitsWithSlots.forEach((unit) => {\n      if (!hasBeenAllocated) {\n        if (unit.unlocks && unit.unlocks.hero) {\n          unit.unlocks.hero--;\n          hasBeenAllocated = true;\n        }\n      }\n    });\n    if (!hasBeenAllocated) {\n      unitsWithSlots.forEach((unit) => {\n        if (!hasBeenAllocated) {\n          if (unit.unlocks && unit.unlocks.heroMonsterTitanOrWarEngineUnique) {\n            unit.unlocks.nonHero = unit.unlocks.heroMonsterTitanOrWarEngineUnique - 1;\n            delete unit.unlocks.heroMonsterTitanOrWarEngineUnique;\n            hasBeenAllocated = true;\n          }\n        }\n      });\n    }\n    if (!hasBeenAllocated) unallocated.hwmt = true;\n  });\n\n  warEngines.forEach((warEngine) => {\n    let hasBeenAllocated = false;\n    unitsWithSlots.forEach((unit) => {\n      if (!hasBeenAllocated) {\n        if (unit.unlocks && unit.unlocks.warEngine) {\n          unit.unlocks.warEngine--;\n          hasBeenAllocated = true;\n        }\n      }\n    });\n    if (!hasBeenAllocated) {\n      unitsWithSlots.forEach((unit) => {\n        if (!hasBeenAllocated) {\n          if (unit.unlocks && unit.unlocks.heroMonsterTitanOrWarEngineUnique) {\n            unit.unlocks.nonWarEngine = unit.unlocks.heroMonsterTitanOrWarEngineUnique - 1;\n            delete unit.unlocks.heroMonsterTitanOrWarEngineUnique;\n            hasBeenAllocated = true;\n          }\n        }\n      });\n    }\n    unitsWithSlots.forEach((unit) => {\n      if (!hasBeenAllocated) {\n        if (unit.unlocks && unit.unlocks.nonHero) {\n          unit.unlocks.nonHero--;\n          hasBeenAllocated = true;\n        }\n      }\n    });\n    if (!hasBeenAllocated) unallocated.hwmt = true;\n  });\n\n  monsters.forEach((monster) => {\n    let hasBeenAllocated = false;\n    unitsWithSlots.forEach((unit) => {\n      if (!hasBeenAllocated) {\n        if (unit.unlocks && unit.unlocks.monsterOrTitan) {\n          unit.unlocks.monsterOrTitan--;\n          hasBeenAllocated = true;\n        }\n      }\n    });\n\n    if (!hasBeenAllocated) {\n      unitsWithSlots.forEach((unit) => {\n        if (!hasBeenAllocated) {\n          if (unit.unlocks && unit.unlocks.heroMonsterTitanOrWarEngineUnique) {\n            unit.unlocks.nonMonster = unit.unlocks.heroMonsterTitanOrWarEngineUnique - 1;\n            delete unit.unlocks.heroMonsterTitanOrWarEngineUnique;\n            hasBeenAllocated = true;\n          }\n        }\n      });\n    }\n    unitsWithSlots.forEach((unit) => {\n      if (!hasBeenAllocated) {\n        if (unit.unlocks && (unit.unlocks.nonHero || unit.unlocks.nonWarEngine)) {\n          unit.unlocks.nonHero--;\n          hasBeenAllocated = true;\n        }\n      }\n    });\n    if (!hasBeenAllocated) unallocated.hwmt = true;\n  });\n\n  titans.forEach((titan) => {\n    let hasBeenAllocated = false;\n    unitsWithSlots.forEach((unit) => {\n      if (!hasBeenAllocated) {\n        if (unit.unlocks && unit.unlocks.monsterOrTitan) {\n          unit.unlocks.monsterOrTitan--;\n          hasBeenAllocated = true;\n        }\n      }\n    });\n    if (!hasBeenAllocated) {\n      unitsWithSlots.forEach((unit) => {\n        if (!hasBeenAllocated) {\n          if (unit.unlocks && unit.unlocks.heroMonsterTitanOrWarEngineUnique) {\n            unit.unlocks.nonTitan = unit.unlocks.heroMonsterTitanOrWarEngineUnique - 1;\n            delete unit.unlocks.heroMonsterTitanOrWarEngineUnique;\n            hasBeenAllocated = true;\n          }\n        }\n      });\n    }\n    unitsWithSlots.forEach((unit) => {\n      if (!hasBeenAllocated) {\n        if (unit.unlocks && (unit.unlocks.nonHero || unit.unlocks.nonWarEngine || unit.unlocks.nonMonster)) {\n          unit.unlocks.nonHero--;\n          hasBeenAllocated = true;\n        }\n      }\n    });\n    if (!hasBeenAllocated) unallocated.hwmt = true;\n  });\n\n  return unallocated;\n};\n\nexport default calculateUnallocated;\n","const calculatePointsTotal = (unitsArr) => {\n  return unitsArr.reduce((total, unit) => {\n    total += unit.unitCost;\n    return total;\n  }, 0);\n};\n\nexport default calculatePointsTotal;\n","const types = ['Hero', 'War Engine', 'Monster', 'Titan'];\n\nconst calculateDuplicates = (pointsTotal, units) => {\n  const maxOfAnyHMWT = pointsTotal < 1500 ? 1 : Math.floor(pointsTotal / 1000) + 1;\n  return units.reduce((isTooMany, unit) => {\n    return (\n      isTooMany ||\n      (types.includes(unit.unitDetails.size) &&\n        units.filter((u) => u.unitDetails.name === unit.unitDetails.name).length > maxOfAnyHMWT)\n    );\n  }, false);\n};\n\nexport default calculateDuplicates;\n","const calculateDuplicateArtefacts = (units) => {\n  const artefacts = {};\n  units.forEach((unit) => {\n    unit.selectedArtefacts.forEach((artefact) => {\n      if (artefacts[artefact.name]) {\n        artefacts[artefact.name]++;\n      } else {\n        artefacts[artefact.name] = 1;\n      }\n    });\n  });\n  return !!Object.values(artefacts).filter((number) => number > 1).length;\n};\n\nexport default calculateDuplicateArtefacts;\n","const calculateUnitLimits = (units) => {\n  return units.reduce((overLimit, unit) => {\n    const limitedOption = unit.selectedOptions.find((option) => option.limit);\n    return (\n      overLimit ||\n      (unit.unitDetails.limit &&\n        units.filter((u) => u.unitDetails.name === unit.unitDetails.name).length > unit.unitDetails.limit) ||\n      (limitedOption &&\n        units.filter(\n          (u) =>\n            u.selectedOptions.find((selectedOption) => limitedOption.name === selectedOption.name)\n        ).length > limitedOption.limit)\n    );\n  }, false);\n};\n\nexport default calculateUnitLimits;\n","import React, { useState, useEffect, useReducer } from 'react';\nimport FactionUnitsIndex from 'components/views/FactionUnitsIndex';\nimport UnitSelect from 'components/views/UnitSelect';\nimport ArmyList from 'components/views/ArmyList';\nimport ArmiesIndex from 'components/views/ArmiesIndex';\nimport { v4 as uuidv4 } from 'uuid';\nimport armiesData from '../../data/armies.json';\nimport artefacts from '../../data/artefacts.json';\nimport calculateUnallocated from '../../helpers/unlocks';\nimport calculatePointsTotal from '../../helpers/points';\nimport calculateDuplicates from '../../helpers/duplicates';\nimport calculateDuplicateArtefacts from '../../helpers/artefacts';\nimport calculateUnitLimits from '../../helpers/limits';\n\nconst Index = () => {\n  const [armies, setArmies] = useState([]);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [display, setDisplay] = useState('armiesIndex');\n  const [selectedArmy, setSelectedArmy] = useState(null);\n  const [selectedUnit, setSelectedUnit] = useState(null);\n  const [fromArmyList, setFromArmyList] = useState(null);\n  const [unallocated, setUnallocated] = useState({});\n  const [points, setPoints] = useState({});\n  const [tooManyDuplicates, setTooManyDuplicates] = useState(null);\n  const [overLimits, setOverLimits] = useState(null);\n  const [artefactDuplicates, setArtefactDuplicates] = useState(null);\n  const [lastTab, setLastTab] = useState(null);\n\n  const initialArmyListState = [];\n\n  const addUnitToListDispatchFunction = (armyListState, action) => {\n    const armyListIndex = armyListState.findIndex((armyList) => armyList.name === action.armyName);\n    const selectedUnit = {\n      unitId: action.unitId,\n      unitDetails: action.unit.unitDetails,\n      originalUnitDetails: action.unit.originalUnitDetails,\n      selectedOptions: action.unit.selectedOptions,\n      selectedArtefacts: action.unit.selectedArtefacts,\n      unitCost: action.unit.unitCost,\n      armyName: action.armyName,\n      formation: action.unit.formation,\n      formationUpgrade: action.unit.formationUpgrade,\n      requiredOptions: action.unit.requiredOptions,\n    };\n    if (armyListIndex === -1) {\n      return [...armyListState, { name: action.armyName, units: [selectedUnit] }];\n    } else {\n      return armyListState.map((army, index) => {\n        if (index !== armyListIndex) return army;\n        return {\n          ...army,\n          units: [...army.units, selectedUnit],\n        };\n      });\n    }\n  };\n\n  const editUnitDispatchFunction = (armyListState, action) => {\n    const armyListIndex = armyListState.findIndex((armyList) => armyList.name === action.unit.armyName);\n    return armyListState.map((army, index) => {\n      if (index !== armyListIndex) return army;\n      return {\n        ...army,\n        units: army.units.map((unit) => {\n          if (unit.unitId !== action.unit.unitId) return unit;\n          return action.unit;\n        }),\n      };\n    });\n  };\n\n  const deleteUnitDispatchFunction = (armyListState, action) => {\n    const armyListIndex = armyListState.findIndex((armyList) => armyList.name === action.unit.armyName);\n    const newArmylistState = armyListState.map((army, index) => {\n      if (index !== armyListIndex) return army;\n      return {\n        ...army,\n        units: army.units.filter((unit) => unit.unitId !== action.unit.unitId),\n      };\n    });\n    const emptyArmy = newArmylistState.find((army) => army.units.length === 0);\n    if (emptyArmy && selectedArmy === emptyArmy.name) {\n      setFromArmyList(false);\n      setSelectedArmy(null);\n      setDisplay('armiesIndex');\n      window.scrollTo(0, 0);\n    }\n    return newArmylistState.filter((army) => army.units.length !== 0);\n  };\n\n  const reducer = (armyListState, action) => {\n    switch (action.type) {\n      case 'addUnitToList':\n        return addUnitToListDispatchFunction(armyListState, action);\n      case 'editUnit':\n        return editUnitDispatchFunction(armyListState, action);\n      case 'deleteUnit':\n        return deleteUnitDispatchFunction(armyListState, action);\n      default:\n        throw new Error();\n    }\n  };\n  const [armyListState, dispatch] = useReducer(reducer, initialArmyListState);\n\n  const init = () => {\n    setIsLoaded(true);\n    setArmies(armiesData);\n    window.scrollTo(0, 0);\n  };\n\n  const processUnlocks = () => {\n    const unallocated = armyListState.reduce((unallocatedObj, army) => {\n      unallocatedObj[army.name] = calculateUnallocated(army.units);\n      return unallocatedObj;\n    }, {});\n    setUnallocated(unallocated);\n  };\n\n  const processPoints = () => {\n    const points = armyListState.reduce((pointsObj, army) => {\n      pointsObj[army.name] = calculatePointsTotal(army.units);\n      return pointsObj;\n    }, {});\n    setPoints(points);\n    return points;\n  };\n\n  const processDuplicates = (newPoints) => {\n    const pointsTotal = Object.keys(newPoints).reduce((sum, key) => {\n      return (sum += newPoints[key]);\n    }, 0);\n    const isTooManyDuplicates = calculateDuplicates(\n      pointsTotal,\n      armyListState.reduce((flattenedUnits, army) => {\n        return [...flattenedUnits, ...army.units];\n      }, [])\n    );\n    setTooManyDuplicates(isTooManyDuplicates);\n  };\n\n  const processLimits = () => {\n    const flattenedUnits = armyListState.reduce((unitsArr, army) => {\n      return [...unitsArr, ...army.units];\n    }, []);\n    const overLimits = calculateUnitLimits(flattenedUnits);\n    setOverLimits(overLimits);\n  };\n\n  const processArtefacts = () => {\n    const flattenedUnits = armyListState.reduce((unitsArr, army) => {\n      return [...unitsArr, ...army.units];\n    }, []);\n    const overLimit = calculateDuplicateArtefacts(flattenedUnits);\n    setArtefactDuplicates(overLimit);\n  };\n\n  useEffect(init, []);\n  useEffect(() => {\n    processUnlocks();\n    const newPoints = processPoints();\n    processDuplicates(newPoints);\n    processArtefacts();\n    processLimits();\n    if (armyListState.length) {\n      setDisplay('armyList');\n      window.scrollTo(0, 0);\n    }\n  }, [armyListState]);\n\n  const handleArmyButtonClick = (armyName) => {\n    setSelectedArmy(armyName);\n    setDisplay('factionUnitsIndex');\n    window.scrollTo(0, 0);\n  };\n\n  const handleAddUnitToListWithArmyAndUnit = (armyName, unit) => {\n    dispatch({ type: 'addUnitToList', armyName, unit, unitId: uuidv4() });\n  };\n\n  const handleAddFormationToListWithArmyAndFormation = (armyName, formationUnits) => {\n    formationUnits.forEach(unit => {\n      dispatch({ type: 'addUnitToList', armyName, unit, unitId: uuidv4() });\n    });\n  };\n\n  const handleDeleteFormationFromList = (formationUnits) => {\n    formationUnits.forEach(unit => {\n      dispatch({ type: 'deleteUnit', unit });\n    });\n  };\n\n  const handleEditUnit = (unit) => {\n    dispatch({ type: 'editUnit', unit });\n  };\n\n  const handleDeleteUnit = (unit) => {\n    dispatch({ type: 'deleteUnit', unit });\n  };\n\n  const handleGoToDisplay = (display) => {\n    setDisplay(display);\n    window.scrollTo(0, 0);\n  };\n\n  const alreadyAddedFormations = armyListState.reduce((unitsArr, army) => {\n    return [...unitsArr, ...army.units];\n  }, []).reduce((formationLabels, unit) => {\n    if (unit.formation && !formationLabels.includes(unit.formation)) formationLabels.push(unit.formation);\n    return formationLabels;\n  },[]);\n\n  if (!isLoaded) {\n    return <div>Loading...</div>;\n  } else if (display === 'armiesIndex') {\n    return (\n      <main>\n        <header>\n          <p className=\"switch-view\">\n            This listbuilder contains units available in Kings of War v3 rules, including changes from the Gamer's Compendium.\n          </p>\n        </header>\n        <ArmiesIndex\n          armies={armies}\n          handleArmyButtonClick={handleArmyButtonClick}\n          goToDisplay={handleGoToDisplay}\n        />\n      </main>\n    );\n  } else if (display === 'factionUnitsIndex') {\n    return (\n      <main>\n        <FactionUnitsIndex\n          army={armies.find((army) => army.name === selectedArmy)}\n          goToDisplay={handleGoToDisplay}\n          selectUnit={setSelectedUnit}\n          selectArmy={setSelectedArmy}\n          fromArmyList={fromArmyList}\n          unallocated={unallocated}\n          displaySelectOtherArmy={false}\n          tooManyDuplicates={tooManyDuplicates}\n          defaultTab={lastTab || 'Inf/HI'}\n          setLastTab={setLastTab}\n          handleAddFormationToListWithArmyAndFormation={handleAddFormationToListWithArmyAndFormation}\n          alreadyAddedFormations={alreadyAddedFormations}\n        />\n      </main>\n    );\n  } else if (display === 'unitSelect' || display === 'unitSelectFormationUnit' || display === 'deleteConfirm') {\n    return (\n      <main>\n          <UnitSelect\n            armyName={selectedArmy}\n            unit={selectedUnit}\n            goToDisplay={handleGoToDisplay}\n            handleAddUnitToListWithArmyAndUnit={handleAddUnitToListWithArmyAndUnit}\n            editingUnit={!!selectedUnit.unitId}\n            hideDeleteButton={display === 'unitSelectFormationUnit'}\n            editUnit={handleEditUnit}\n            deleteUnit={handleDeleteUnit}\n            deleteConfirm={display === 'deleteConfirm'}\n            availableArtefacts={artefacts}\n          />\n      </main>\n    );\n  } else if (display === 'armyList') {\n    return (\n      <main>\n        <ArmyList\n          armyList={armyListState}\n          goToDisplay={handleGoToDisplay}\n          setFromArmyList={setFromArmyList}\n          selectUnit={setSelectedUnit}\n          unallocated={unallocated}\n          points={points}\n          tooManyDuplicates={tooManyDuplicates}\n          artefactDuplicates={artefactDuplicates}\n          overLimits={overLimits}\n          handleDeleteFormationFromList={handleDeleteFormationFromList}\n        />\n      </main>\n    );\n  }\n};\n\nexport default Index;\n","import React, { Fragment } from 'react';\nimport Index from './Index';\n\nconst StandardIndex = () => {\n  return (\n    <Fragment>\n      <Index type=\"standard\" />\n    </Fragment>\n  );\n};\n\nexport default StandardIndex;\n","import React, { useEffect } from 'react';\nimport StandardIndex from 'components/views/StandardIndex';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport ReactGA from 'react-ga';\n\nconst App = () => {\n  const initGA = () => {\n    ReactGA.initialize('UA-213455639-1');\n    ReactGA.pageview('Landing page');\n  }\n\n  useEffect(() => {\n    initGA();\n  });\n\n  return (\n    <Router>\n      <Route exact path=\"/listbuilder\" component={StandardIndex} />\n    </Router>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}